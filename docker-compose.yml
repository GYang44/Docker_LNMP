# web server
nginx:
  image: nginx:latest
  ports:
    - "80:80"
    - "443:443"
  volumes:
    # app
    - ./app/src:/usr/share/nginx/html:z 
    # nginx configs
    - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    - ./nginx/conf.d/:/etc/nginx/conf.d/:ro
    # certificates
    - ./certs/cert.pem:/etc/nginx/cert.pem:ro
    - ./certs/privkey.pem:/etc/nginx/privkey.pem:ro
  links:
    - fpm:__DOCKER_PHP_FPM__

# php-fpm
fpm:
  #build: ./php-fpm
  image: php:fpm
  ports:
    - "9000"
  volumes:
    - ./app/src:/usr/share/nginx/html:z 
    # Your php.ini
    - ./php-fpm/php.ini-production:/usr/local/etc/php/php.ini:ro
  #environment:
    # Set your APP env variables here:
    # - APP_KEY=
    # - DB_PORT=3306
    # - DB_HOST=127.0.0.1
    # - DB_DATABASE=ttRss
    # - DB_USERNAME=gyang
    # - DB_PASSWORD=479283
  links:
    - mysql

# database
mysql:
  image: mariadb:latest
  ports:
    # Allow client to access 3306
    - "3306:3306"
  volumes:
    # NOTE: your data will be stored in ./mysql
    - ./mysql/data:/var/lib/mysql
    #- ./mysql/my.cnf:/etc/mysql/conf.d/docker.cnf
  environment:
    - MYSQL_ROOT_PASSWORD=test1234
